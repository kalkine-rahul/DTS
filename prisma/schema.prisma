import bcrypt from 'bcryptjs'
import jwt from 'jsonwebtoken'
import { prisma } from './prisma'

// Verify password
export async function verifyPassword(plain: string, hash: string) {
return bcrypt.compare(plain, hash)
}

// Generate JWT token
export function generateToken(payload: object) {
return jwt.sign(payload, process.env.JWT_SECRET || 'default_secret', {
expiresIn: '7d',
})
}

// Create activity log for user actions
export async function createActivityLog(
userId: string,
action: string,
details: string,
ipAddress?: string,
userAgent?: string
) {
try {
await prisma.activityLog.create({
data: {
userId,
action,         // ✔ matches schema
details,        // ✔ matches schema
ipAddress,      // ✔ matches schema
userAgent,      // ✔ matches schema
},
})
} catch (error) {
console.error('Activity log error:', error)
}
}
